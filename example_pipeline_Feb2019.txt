########################################
### Quality control and sample match ###
######################################## 

bash QualityControl_GT.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/GSA-24v2-0_A1.csv /mnt/Genotyping/PAR_Coord_GRCh37.txt /mnt/Genotyping/genotyping_Feb2019/ 10

# M00969_annotation_file.csv manually created and modified (pre and post)
bash GT_match.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ M00969 /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file.csv 
 
# manually create a .txt file that contains the samples of interest
bash Create_SampleID.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv  /mnt/Genotyping/genotyping_Feb2019/Samples_name.txt

#######################################

#######################
### obtain vcf file ###
####################### 

bash GetRefAlt.sh /mnt/Genotyping/GSA-24v2-0_A1.csv /mnt/Genotyping/hg19.fa 8 23 

bash CreateVcf.sh /mnt/Genotyping/genotyping_Feb2019/ /mnt/Software/PLINK1.9/ genomestudio_output 

bash CorrectAltRefVCF.sh /mnt/Genotyping/genotyping_Feb2019/plink.vcf /mnt/Genotyping/GSA-24v2-0_A1.csv_reference_alleles 

bash Preproc_cnv.sh /mnt/Genotyping/genotyping_Feb2019/ /mnt/Software/PLINK1.9/

#######################

# mkdir summary_res/

#########################
### pairwise analysis ###
#########################

sample_name_pair=(BJ FOK17 FOK5 FOK53 FOK60 FOK84 HLF HDF IMR90 RPE)
  
for id in ${sample_name_pair[@]}
do
	echo ${id}

	bash Cnv_Analysis.sh  /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id} 

	bash Cnv_Diff.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id} /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv

	bash Cnv_Plot.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id}

	# check quality
	bash Cnv_Plot_LRR-BAF.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id} /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv 9

done

# optional, if some of the chromosomes wants to be invistigated
bash Cnv_Plot_LRR-BAF.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_BJ_1.txt BJ /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv 4
bash Cnv_Plot_LRR-BAF.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_IMR90_1.txt IMR90 /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv 3 
bash Cnv_Plot_LRR-BAF.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_IMR90_1.txt IMR90 /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv 4


#######################################

sample_name_single=(BD39 BD394 BD612 BD689 BD925)


for id in ${sample_name_single[@]}
do
        echo ${id}

        bash Cnv_Analysis_Single.sh  /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id}

        bash Cnv_Det_Single.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id} /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv

        bash Cnv_Plot_Single.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id}

	bash Cnv_Plot_LRR-BAF_Single.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_${id}_1.txt ${id} /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv 9

done

# optional, if some of the chromosomes wants to be invistigated
bash Cnv_Plot_LRR-BAF_Single.sh /mnt/Genotyping/Rscripts/ /mnt/Genotyping/genotyping_Feb2019/ /mnt/Genotyping/genotyping_Feb2019/ID_BD39_1.txt BD39 /mnt/Genotyping/genotyping_Feb2019/M00969_annotation_file_GTmatch.csv 13
